<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="pageTitle">Loading...</title>
<meta id="metaDescription" name="description" content="Official artist website.">
<meta id="metaAuthor" name="author" content="Artist">
<meta name="keywords" content="music, artist, tour, songs, videos, albums">

<!-- Open Graph -->
<meta property="og:title" id="ogTitle" content="Artist | Official Website">
<meta property="og:description" id="ogDescription" content="Listen, watch, and connect.">
<meta property="og:image" id="ogImage" content="assets/default-cover.jpg">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" id="twitterTitle" content="Artist | Official Website">
<meta name="twitter:description" id="twitterDescription" content="Listen, watch, and connect.">
<meta name="twitter:image" id="twitterImage" content="assets/default-cover.jpg">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">

<style>

</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top shadow-sm">
  <div class="container">
    <a id="navBrand" class="navbar-brand fw-bold" href="#">Artist</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
      data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" 
      aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav text-center">
        <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
        <li class="nav-item"><a class="nav-link" href="#music">Music</a></li>
        <li class="nav-item"><a class="nav-link" href="#videos">Videos</a></li>
        <li class="nav-item"><a class="nav-link" href="#events">Events</a></li>
        <li class="nav-item"><a class="nav-link" href="#gallery">Gallery</a></li>
        <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- Hero -->
<header id="hero">
  <div class="container">
    <h1 id="heroName" class="display-3 fw-bold">Loading...</h1>
    <p id="heroTagline" class="lead">Please wait</p>
    <a href="#music" class="btn btn-primary btn-lg mt-3">Listen Now</a>
  </div>
</header>

<!-- About -->
<section id="about" class="py-5">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">About</h2>
    <p id="aboutBio" class="lead">Loading bio...</p>
  </div>
</section>

<!-- Music -->
<section id="music" class="py-5 bg-light">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Music <span class="counter" id="albumsCounter">0</span></h2>
    <div id="albumsContainer" class="row g-4 justify-content-center"></div>
  </div>
</section>

<!-- Videos -->
<section id="videos" class="py-5">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Videos <span class="counter" id="videosCounter">0</span></h2>
    <div id="videosContainer" class="row g-4"></div>
  </div>
</section>

<!-- Events -->
<section id="events" class="py-5 bg-light">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Events <span class="counter" id="eventsCounter">0</span></h2>
    <div id="eventsContainer" class="row g-4 justify-content-center"></div>
  </div>
</section>

<!-- Gallery -->
<section id="gallery" class="py-5">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Gallery</h2>
    <div id="galleryContainer" class="row g-4 justify-content-center"></div>
  </div>
</section>

<!-- Contact -->
<section id="contact" class="py-5 bg-light">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Contact</h2>
    <p>Email: <a id="contactEmail" href="#">Loading...</a></p>
    <div id="socialLinks" class="d-flex flex-wrap justify-content-center gap-2 mt-3"></div>
  </div>
</section>

<!-- Footer -->
<footer class="bg-dark text-white text-center py-4">
  <p class="mb-0">&copy; <span id="year"></span> <span id="footerName">Artist</span>. All rights reserved.</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDsPKvHw4pmk_st5S7tThW3nMZCfVulW7A",
  authDomain: "mzsue-df11c.firebaseapp.com",
  projectId: "mzsue-df11c",
  storageBucket: "mzsue-df11c.appspot.com",
  messagingSenderId: "524697523710",
  appId: "1:524697523710:web:0acc49354ee82350929caf",
  measurementId: "G-SXTX1JEV7H"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
document.getElementById("year").textContent = new Date().getFullYear();

async function loadContent() {
  const mainSnap = await getDoc(doc(db, "siteContent", "main"));
  const albumsSnap = await getDoc(doc(db, "siteContent", "albums"));
  const videosSnap = await getDoc(doc(db, "siteContent", "videos"));
  const eventsSnap = await getDoc(doc(db, "siteContent", "events"));
  const socialsSnap = await getDoc(doc(db, "siteContent", "socials"));
  const gallerySnap = await getDoc(doc(db, "siteContent", "gallery"));

  const data = mainSnap.exists() ? mainSnap.data() : {};
  document.getElementById("heroName").textContent = data.name || "Artist";
  document.getElementById("navBrand").textContent = data.name || "Artist";
  document.getElementById("footerName").textContent = data.name || "Artist";
  document.title = `${data.name || "Artist"} | Official Website`;
  if (data.tagline) document.getElementById("heroTagline").textContent = data.tagline;

  // Lazy-load hero image with blur-up
  if (data.heroImage) {
    const img = new Image();
    img.src = data.heroImage;
    img.onload = () => {
      document.getElementById("hero").style.backgroundImage = `url(${data.heroImage})`;
      document.getElementById("hero").classList.add("loaded");
    };
  }

  if (data.bio) {
    document.getElementById("metaDescription").content = data.bio;
    document.getElementById("ogDescription").content = data.bio;
    document.getElementById("twitterDescription").content = data.bio;
    document.getElementById("aboutBio").textContent = data.bio;
  }
  if (data.heroImage) {
    document.getElementById("ogImage").content = data.heroImage;
    document.getElementById("twitterImage").content = data.heroImage;
  }

  const headings = document.querySelectorAll('section h2');
  const headingObserver = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if(entry.isIntersecting) entry.target.classList.add('visible');
    });
  }, {threshold:0.2});
  headings.forEach(h => headingObserver.observe(h));

  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if(entry.isIntersecting) entry.target.classList.add('visible');
    });
  }, {threshold:0.2});

  function renderCards(container, items, templateFunc){
    container.innerHTML='';
    items.forEach(item=>{
      const col=document.createElement('div');
      col.className='col-sm-6 col-md-4 fade-in';
      col.innerHTML=templateFunc(item);
      container.appendChild(col);
      observer.observe(col);
    });
  }

  const albums = albumsSnap.exists()?albumsSnap.data().items||[]:[];
  renderCards(document.getElementById('albumsContainer'), albums, a => `
    <div class="card h-100 shadow-sm">
      <img src="${a[1]}" alt="${a[0]}" class="card-img-top" loading="lazy">
      <div class="card-body">
        <h5 class="card-title">${a[0]}</h5>
        <a href="${a[2]}" target="_blank" class="btn btn-outline-primary btn-sm">Listen</a>
      </div>
    </div>`);

  const videos = videosSnap.exists()?videosSnap.data().items||[]:[];
  renderCards(document.getElementById('videosContainer'), videos, v => `
    <div class="ratio ratio-16x9 shadow-sm rounded overflow-hidden">
      <iframe src="${v[1]}" title="${v[0]}" allowfullscreen loading="lazy"></iframe>
    </div>`);

  const events = eventsSnap.exists()?eventsSnap.data().items||[]:[];
  renderCards(document.getElementById('eventsContainer'), events, ev => `
    <div class="card h-100 shadow-sm">
      <img src="${ev[3]}" alt="${ev[0]}" class="card-img-top" loading="lazy">
      <div class="card-body text-center">
        <h5 class="card-title">${ev[0]}</h5>
        <p class="card-text">${ev[1]} | ${ev[2]}</p>
      </div>
    </div>`);

  const gallery = gallerySnap.exists()?gallerySnap.data().items||[]:[];
  renderCards(document.getElementById('galleryContainer'), gallery, g => `
    <div class="card h-100 shadow-sm">
      <img src="${g[0]}" alt="${g[1]}" class="card-img-top" loading="lazy">
      <div class="card-body text-center">
        <p class="card-text">${g[1]}</p>
      </div>
    </div>`);

  if(data.contactEmail){
    document.getElementById("contactEmail").textContent=data.contactEmail;
    document.getElementById("contactEmail").href=`mailto:${data.contactEmail}`;
  }
  const socialsContainer = document.getElementById("socialLinks");
  socialsContainer.innerHTML="";
  const socials = socialsSnap.exists()?socialsSnap.data().items||[]:[];
  socials.forEach(s=>{
    socialsContainer.innerHTML+=`<a href="${s[1]}" target="_blank" class="btn btn-outline-light btn-sm" aria-label="${s[0]}">${s[0]}</a>`;
  });

  function animateCounter(id, value){
    let count=0;
    const step=Math.ceil(value/100);
    const interval=setInterval(()=>{
      count+=step;
      if(count>=value){ count=value; clearInterval(interval); }
      document.getElementById(id).textContent=count;
    },15);
  }
  animateCounter('albumsCounter', albums.length);
  animateCounter('videosCounter', videos.length);
  animateCounter('eventsCounter', events.length);
}

window.addEventListener('load', ()=>document.getElementById('hero').classList.add('visible'));
loadContent();
</script>
</body>
</html>
