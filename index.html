<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="pageTitle">Loading...</title>
<meta id="metaDescription" name="description" content="Official artist website.">
<meta id="metaAuthor" name="author" content="Artist">
<meta name="keywords" content="blues, music, artist, tour, songs, videos, albums">

<!-- Open Graph -->
<meta property="og:title" id="ogTitle" content="Artist | Official Website">
<meta property="og:description" id="ogDescription" content="Listen, watch, and connect.">
<meta property="og:image" id="ogImage" content="assets/default-cover.jpg">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" id="twitterTitle" content="Artist | Official Website">
<meta name="twitter:description" id="twitterDescription" content="Listen, watch, and connect.">
<meta name="twitter:image" id="twitterImage" content="assets/default-cover.jpg">

<link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png">
<link rel="manifest" href="/images/favicons/site.webmanifest">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Make sure Font Awesome is included in your <head> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* General */
html { scroll-behavior: smooth; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
body { background-color: #0b0b0b; color: #f5f5f5; }

/* Navbar */
.navbar { background: rgba(0,0,0,0.85)!important; backdrop-filter: blur(6px); }
.navbar-brand { font-family: 'Georgia', serif; letter-spacing: 1px; }

/* Hero */
#hero { position: relative; height: 100vh; display: flex; align-items: center; justify-content: center; text-align: center; color: #fff; overflow: hidden; }
#hero video { position: absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; z-index:0; filter: brightness(0.5); }
#hero::after { content:''; position:absolute; top:0; left:0; width:100%; height:100%; background: linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.6)); z-index:1; }
#hero .container { position: relative; z-index:2; }
#hero h1, #hero p, #hero a { opacity:0; transform: translateY(20px); transition: all 1s ease-out; }
#hero.visible h1, #hero.visible p, #hero.visible a { opacity:1; transform: translateY(0); }
#hero h1 { font-size: 4rem; text-shadow: 2px 2px 8px #000; }

/* Sections */
section { padding: 5rem 0; }
section h2 { opacity:0; transform: translateY(20px); transition: all 0.8s ease-out; text-shadow:1px 1px 5px #000; }
section h2.visible { opacity:1; transform: translateY(0); }

/* Cards */
.fade-in { opacity:0; transform: translateY(20px); transition: all 0.8s ease-out; }
.fade-in.visible { opacity:1; transform: translateY(0); }
.card { transition: transform 0.3s, box-shadow 0.3s; border:none; }
.card:hover { transform: translateY(-5px) scale(1.03); box-shadow: 0 15px 25px rgba(0,0,0,0.3); }
.card-title { color: #0d6efd; }

/* Buttons */
.btn-outline-primary:hover { background-color: #0d6efd; color: #fff; border-color: #0d6efd; }
.btn-outline-light:hover { background-color: #fff; color:#0b0b0b; }

/* Counters */
.counter { font-weight: 700; font-size: 2rem; color: #0d6efd; }

/* Newsletter */
#newsletter input { width: 300px; max-width: 90%; display: inline-block; margin-right: 0.5rem; }

/* Gallery Lightbox */
#galleryContainer img { cursor: pointer; transition: transform 0.3s; }
#galleryContainer img:hover { transform: scale(1.05); }

#socialLinks a i, 
#socialLinksFooter a i {
  font-size: 1.5rem; /* adjust size as needed */
  color: #333; /* dark grey for visibility on white */
  transition: color 0.3s; /* smooth hover effect */
}

#socialLinks a:hover i, 
#socialLinksFooter a:hover i {
  color: #1da1f2; /* example: change color on hover */
}

#socialLinksFooter a {
  font-size: 1.5rem; /* adjust size as needed */
  color: #333; /* dark grey for visibility on white */
  transition: color 0.3s; /* smooth hover effect */
}

.gallery-card img {
  height: 250px;       /* fixed height */
  object-fit: cover;   /* makes sure image fills card nicely */
  cursor: pointer;     /* indicates clickability */
  border-radius: 8px;
  transition: transform 0.3s ease;
}
.gallery-card img:hover {
  transform: scale(1.05);
}

</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top shadow-sm">
  <div class="container">
    <a id="navBrand" class="navbar-brand fw-bold" href="#">Artist</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
      data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" 
      aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav text-center">
        <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
        <li class="nav-item"><a class="nav-link" href="#music">Music</a></li>
        <li class="nav-item"><a class="nav-link" href="#videos">Videos</a></li>
        <li class="nav-item"><a class="nav-link" href="#events">Events</a></li>
        <li class="nav-item"><a class="nav-link" href="#gallery">Gallery</a></li>
        <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- Hero -->
<header id="hero">
  <video autoplay muted loop playsinline id="heroVideo">
    <source src="assets/hero-blues.mp4" type="video/mp4">
  </video>
  <div class="container">
    <h1 id="heroName" class="display-3 fw-bold">Loading...</h1>
    <p id="heroTagline" class="lead">Please wait</p>
    <a href="#music" class="btn btn-primary btn-lg mt-3">Listen Now</a>
  </div>
</header>

<!-- About -->
<section id="about" class="py-5">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">About</h2>
    <p id="aboutBio" class="lead">Loading bio...</p>
  </div>
</section>

<!-- Music -->
<section id="music" class="py-5 bg-light text-dark">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Music <span class="counter" id="albumsCounter">0</span></h2>
    <div id="albumsContainer" class="row g-4 justify-content-center"></div>
  </div>
</section>

<!-- Videos -->
<section id="videos" class="py-5">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Videos <span class="counter" id="videosCounter">0</span></h2>
    <div id="videosContainer" class="row g-4"></div>
  </div>
</section>

<!-- Events -->
<section id="events" class="py-5 bg-light text-dark">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Events <span class="counter" id="eventsCounter">0</span></h2>
    <div id="eventsContainer" class="row g-4 justify-content-center"></div>
  </div>
</section>

<!-- Gallery -->
<section id="gallery" class="py-5">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Gallery</h2>
    <div id="galleryContainer" class="row g-4 justify-content-center"></div>
  </div>
</section>

<!-- Contact / Newsletter -->
<section id="contact" class="py-5 bg-light text-dark">
  <div class="container text-center">
    <h2 class="fw-bold mb-4">Contact & Newsletter</h2>
    <p>Email: <a id="contactEmail" href="#">Loading...</a></p>
    <p>Number: <small id="contactNumber">Loading...</small></p>

    <div id="socialLinks" class="d-flex flex-wrap justify-content-center gap-2 mt-3"></div>

<form id="newsletter" class="py-5 bg-light text-dark">
  <div class="mb-2">
    <input type="text" id="newsletterName" class="form-control" placeholder="Enter your name" required>
  </div>
  <div class="mb-2">
    <input type="email" id="newsletterEmail" class="form-control" placeholder="Enter your email" required>
  </div>
  <button type="submit" class="btn btn-primary w-100">Subscribe</button>
</form>

  </div>
</section>

<!-- Footer -->
<footer class="bg-white mt-5 p-4 text-center shadow-sm rounded"> 
        
    
    <div id="socialLinksFooter" class="d-flex flex-wrap justify-content-center gap-2 mt-3"></div>

  <div class="mb-2">
    <div class="text-decoration-none text-primary fw-semibold" id="footerName"></div> | 
    <a href="../admin" class="text-decoration-none text-secondary">Admin Dashboard</a>
  </div>
  <div class="text-muted">
    Copyright &copy; <span id="currentYear"></span> <a href="../" target="_blank" class="text-decoration-none text-primary fw-semibold">MzSuMac.com</a><br>
    Created by <a href="https://rw-501.github.io/Portfolio/" target="_blank" class="text-decoration-none text-primary">Ron W.</a> All rights reserved.
  </div>
</footer>


<!-- Modal -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalCaption"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <img id="modalImage" src="" alt="" class="img-fluid rounded shadow">
      </div>
    </div>
  </div>
</div>


<script>
  // Dynamically update the year
  document.getElementById('currentYear').textContent = new Date().getFullYear();
</script>


<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc  } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";


// ===== Toast Helper =====
function showToast(msg, type="success"){
  const wrapper = document.createElement("div");
  wrapper.className = `toast align-items-center text-bg-${type} border-0 show mb-2`;
  wrapper.innerHTML = `<div class="d-flex"><div class="toast-body">${msg}</div>
    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div>`;
  document.querySelector(".toast-container").appendChild(wrapper);
  setTimeout(()=>wrapper.remove(),4000);
}


const firebaseConfig = {
  apiKey: "AIzaSyDsPKvHw4pmk_st5S7tThW3nMZCfVulW7A",
  authDomain: "mzsue-df11c.firebaseapp.com",
  projectId: "mzsue-df11c",
  storageBucket: "mzsue-df11c.firebasestorage.app",
  messagingSenderId: "524697523710",
  appId: "1:524697523710:web:0acc49354ee82350929caf",
  measurementId: "G-SXTX1JEV7H"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadContent(){
  const mainSnap = await getDoc(doc(db,"siteContent","main"));
  const albumsSnap = await getDoc(doc(db,"siteContent","albums"));
  const videosSnap = await getDoc(doc(db,"siteContent","videos"));
  const eventsSnap = await getDoc(doc(db,"siteContent","events"));
  const socialsSnap = await getDoc(doc(db,"siteContent","socials"));
  const gallerySnap = await getDoc(doc(db,"siteContent","gallery"));

  const data = mainSnap.exists()?mainSnap.data():{};
  document.getElementById("heroName").textContent = data.name||"Artist";
  document.getElementById("navBrand").textContent = data.name||"Artist";
  document.getElementById("footerName").textContent = data.name||"Artist";
  document.title = `${data.name||"Artist"} | Official Website`;
  if(data.tagline) document.getElementById("heroTagline").textContent=data.tagline;

  // Hero video fallback image
  if(data.heroImage) document.getElementById("heroVideo").poster = data.heroImage;

  if(data.bio){
    document.getElementById("metaDescription").content = data.bio;
    document.getElementById("ogDescription").content = data.bio;
    document.getElementById("twitterDescription").content = data.bio;
    document.getElementById("aboutBio").innerHTML = data.bio;
  }
  if(data.heroImage){
    document.getElementById("ogImage").content = data.heroImage;
    document.getElementById("twitterImage").content = data.heroImage;
  }

  // Scroll reveal headings
  const headings=document.querySelectorAll('section h2');
  const observerHeading=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting)entry.target.classList.add('visible');});},{threshold:0.2});
  headings.forEach(h=>observerHeading.observe(h));

  // Card fade-in observer
  const observerCard=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting)entry.target.classList.add('visible');});},{threshold:0.2});
  function renderCards(container,items,template){
    container.innerHTML='';
    items.forEach(item=>{
      const col=document.createElement('div');
      col.className='col-sm-6 col-md-4 fade-in';
      col.innerHTML=template(item);
      container.appendChild(col);
      observerCard.observe(col);
    });
  }
// ---- ALBUMS ----
const rawAlbums = albumsSnap.exists() ? albumsSnap.data().items || [] : [];
const albums = rawAlbums.map(item => {
  const title = item.texts?.[0] || "";
  const cover = item.files?.[0] || "";   // cover image
  const audio = item.files?.[1] || "";   // audio link
  return [title, cover, audio];
});

renderCards(document.getElementById('albumsContainer'), albums, a => `
  <div class="card h-100 shadow-sm album-card">
    <img src="${a[1]}" alt="${a[0]}" class="card-img-top" loading="lazy">
    <div class="card-body text-center">
      <h5 class="card-title">${a[0]}</h5>
      ${a[2] ? `<audio controls src="${a[2]}" preload="none"></audio>` : ""}
    </div>
  </div>
`);


// ---- VIDEOS ----
const rawVideos = videosSnap.exists() ? videosSnap.data().items || [] : [];
const videos = rawVideos.map(item => {
  const title = item.texts?.[0] || "";
  const embed = item.texts?.[1] || "";
  return [title, embed];
});
console.log("🔥 Raw rawVideos Data:", rawVideos);

renderCards(document.getElementById('videosContainer'), videos, v => `
  <div class="ratio ratio-16x9 shadow-sm rounded overflow-hidden video-card">
    <iframe src="${v[1]}" title="${v[0]}" allowfullscreen loading="lazy"></iframe>
  </div>
`);


// ---- EVENTS ----
const rawEvents = eventsSnap.exists() ? eventsSnap.data().items || [] : [];
const events = rawEvents.map(item => {
  const name = item.texts?.[0] || "";
  const date = item.texts?.[1] || "";
  const venue = item.texts?.[2] || "";
  const flyer = item.files?.[0] || "";
  return [name, date, venue, flyer];
});
console.log("🔥 Raw rawEvents Data:", rawEvents);

renderCards(document.getElementById('eventsContainer'), events, ev => `
  <div class="card h-100 shadow-sm event-card">
    <img src="${ev[3]}" alt="${ev[0]}" class="card-img-top" loading="lazy">
    <div class="card-body text-center">
      <h5 class="card-title">${ev[0]}</h5>
      <p class="card-text">${ev[1]} | ${ev[2]}</p>
    </div>
  </div>
`);

const rawGallery = gallerySnap.exists() ? gallerySnap.data().items || [] : [];

console.log("🔥 Raw Gallery Data:", rawGallery);

// Normalize: expect {file, text}
const gallery = rawGallery.map(item => {
  const file = item.file || "";      // single file
  const caption = item.text || "";   // single caption
  return [file, caption];
});

renderCards(document.getElementById("galleryContainer"), gallery, g => `
  <div class="card h-100 shadow-sm gallery-card" style="background-color: unset;">
    <img src="${g[0]}" 
         alt="${g[1]}" 
         class="card-img-top gallery-img" 
         loading="lazy"
         data-bs-toggle="modal"
         data-bs-target="#imageModal"
         data-img="${g[0]}" 
         data-caption="${g[1]}">
    <div class="card-body text-center">
      <p class="card-text">${g[1]}</p>
    </div>
  </div>
`);


// Handle modal content population
document.addEventListener("click", e => {
  if (e.target.classList.contains("gallery-img")) {
    const modalImg = document.getElementById("modalImage");
    const modalCaption = document.getElementById("modalCaption");
    modalImg.src = e.target.dataset.img;
    modalCaption.textContent = e.target.dataset.caption || "";
  }
});



  if(data.contactEmail){
    document.getElementById("contactEmail").textContent=data.contactEmail;
    document.getElementById("contactEmail").href=`mailto:${data.contactEmail}`;
    document.getElementById("contactNumber").innerText=`${data.contactNumber}`;
  }

 const socialsData = [
  ["LinkedIn", "https://www.linkedin.com/in/mz-su-mac-0819403a/"],
  ["ReverbNation", "https://www.reverbnation.com/mzsumac"],
  ["Spotify", "https://open.spotify.com/track/5qDosedMFwz93ekgrlIrBK"],
  ["YouTube", "https://www.youtube.com/watch?v=IgBcQvoQ6gU&t=7s"],
  ["Website", "https://mzsumac.weebly.com/"],
  ["Apple Music", "https://music.apple.com/us/artist/mz-sumac/1469696748"],
  ["Facebook", "https://www.facebook.com/people/Mz-SuMac/100037191832912/"]
];

// Mapping social name to Font Awesome icons
const iconMap = {
  "LinkedIn": "fab fa-linkedin",
  "ReverbNation": "fas fa-music",
  "Spotify": "fab fa-spotify",
  "YouTube": "fab fa-youtube",
  "Website": "fas fa-globe",
  "Apple Music": "fab fa-apple",
  "Facebook": "fab fa-facebook"
};

const socials = document.getElementById("socialLinks");
const socialLinksFooter = document.getElementById("socialLinksFooter");
socials.innerHTML = ""; // clear existing
socialLinksFooter.innerHTML = ""; // clear existing

socialsData.forEach(s => {
  const name = s[0];
  const url = s[1];
  const iconClass = iconMap[name] || "fas fa-link"; // fallback icon
  socials.innerHTML += `
    <a href="${url}" target="_blank" class="btn btn-outline-light btn-sm me-1" aria-label="${name}">
      <i class="${iconClass}"></i>
    </a>
  `;
    socialLinksFooter.innerHTML += `
    <a href="${url}" target="_blank" class="btn btn-outline-light btn-sm me-1" aria-label="${name}">
      <i class="${iconClass}"></i>
    </a>
  `;
});

  // Animate counters
  function animateCounter(id,value){
    let count=0;
    const step=Math.ceil(value/100);
    const interval=setInterval(()=>{count+=step;if(count>=value){count=value;clearInterval(interval);}document.getElementById(id).textContent=count;},15);
  }
  animateCounter('albumsCounter',albums.length);
  animateCounter('videosCounter',videos.length);
  animateCounter('eventsCounter',events.length);
}


document.getElementById("newsletter").addEventListener("submit", async (e) => {
  e.preventDefault();

  const name = document.getElementById("newsletterName").value.trim();
  const email = document.getElementById("newsletterEmail").value.trim();

  if (!name || !email) {
    showToast("Please enter both name and email", "danger");
    return;
  }

  try {
    // Example: save to Firestore under a "newsletter" collection
    await setDoc(doc(db, "newsletter", email), {
      name,
      email,
      subscribedAt: new Date().toISOString()
    });

    showToast("Thank you for subscribing, " + name + "!");
    document.getElementById("newsletter").reset();
  } catch (err) {
    console.error(err);
    showToast("Subscription failed: " + err.message, "danger");
  }
});

window.addEventListener('load',()=>document.getElementById('hero').classList.add('visible'));
loadContent();
</script>
</body>
</html>
